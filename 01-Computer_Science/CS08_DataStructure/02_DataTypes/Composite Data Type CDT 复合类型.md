---
Date: 2024-01-16
tags:
  - 计算机/数据结构
  - 计算机
  - 计算机/编程语言/C
  - 计算机/数据结构/复合类型
Type:
  - Lecture
Year:
  - 2024 Spring
Status: true
---
# 复合类型

在编程语言中，最基本的、不可再分的数据类型称为基本类型（Primitive Type），例如整型、浮点型；根据语法规则由基本类型组合而成的类型称为复合类型（Compound Type），例如字符串是由很多字符组成的。有些场合下要把复合类型当作一个整体来用，而另外一些场合下需要分解组成这个复合类型的各种基本类型，复合类型的这种两面性为数据抽象（Data Abstraction）奠定了基础。[SICP]指出，在学习一门编程语言时要特别注意以下三个方面：

1. 这门语言提供了哪些基本类型Primitive，比如基本运算符、表达式和语句。

2. 这门语言提供了哪些组合规则Composition，比如基本类型如何组成复合类型，简单的表达式和语句如何组成复杂的表达式和语句。

3. 这门语言提供了哪些抽象机制Abstraction，包括数据抽象和过程抽象（Procedure Abstraction）。

![[DATASTRUCT.png| center | 500]]

## 复合类型的构成

数据类型按照机器语言的组合程度可以分为基本、复合和抽象。基本与复合的数据类型按照内容又可分为<mark style="background: #BBFABBA6;">值类型</mark>与<mark style="background: #BBFABBA6;">引用类型</mark>，对于相对底层的语言，值类型和引用类型互相组合可以实现更加抽象的数据类型。比如由结构体（Struct）和指针（Pointer）组成的各类树（Tree）或者图（Graph）

### 值类型
基础类型（数字、字符串、字符、布尔）以及数值型复合类型都属于值类型。对于值类型，即便我们在声明的时候都没有为其初始化值，那么<font color="#fac08f">编译器会依据它们的零值为它们申请好内存空间</font>（分配于栈上），所以对于值类型**大部分的时候**我们都不必费心为其申请内存空间。

> [!caution] 声明变量
> 这并不意味着声明变量是不必要的！对于静态类型的语言，声明变量就是在告诉计算机需要分配多少空间。同时，变量的类型决定了变量存储占用的空间，以及如何解释存储的位模式。

值得注意的是，在一些更加底层的语言中，值类型可能只有数值型（整数、浮点）而其他基础类型也是在数值型的基础上产生的。比如[[C 字符串]]就不是基础类型而是复合类型，由数个`char`组成数组来表示。

### 引用类型
引用型复合类型（指针、引用）、函数、接口类型都属于引用类型。在计算机科学中，引用（英语：reference）是指一个可以让程序间接访问于电脑存储器或其他存储设备中一特定资料的值，该数据可以为变量或记录。

引用和资料本身不同。一般而言，引用会是资料存储于存储器或存储设备中的物理地址。因此，引用亦常被称为该资料的指针或地址。不过，引用也被用来指资料地址和某一固定“基准”地址的偏移值，或是数组的索引。

> [!NOTE] 引用的本质
> 引用的概念和其他如关系键或识别字之类用来识别特定资料项目的值不同，后者只能透过数据库表中的查找运算，来访问资料。而引用类型的数据是可以实实在在的影响被引用者的内容的。比如指针就可以在不声明新变量的情况下直接修改指定地址的数据

引用被广泛用于程序设计之中，尤其是用于将大量或易变的资料有效地透过参数传给子程序，或在不同的用途中共享此类资料。此外，引用也能指向一个包含其他资料之引用的变量或记录，**此一概念为间接寻址及链接数据结构（如链接串列）之基础**。

## 复合类型的实现

我们以C语言作为学习如何复合类型的基础。因为C语言是一种通用的、面向过程式的计算机程序设计语言，可以更好的理解计算机的底层逻辑。复合类型是一种资料类型，它可以原始类型和其它的复合类型所构成。实现这种构成的动作也称作组合（Composition）。

要在类C语言中实现复合类型的数据结构，通常涉及到以下几个关键元素：

1. [[C 结构体|结构体]]
2. [[C 指针|指针]]
3. [[C 头文件|头文件]]

以实现一个链表为例，我们可能会在头文件中定义作为链表节点的结构体node，并[[C 函数#函数声明|声明]]需要添加的方法：

```c
//条件语句防止同名头文件被编译两次
#ifndef LINK_H
#define LINK_H

typedef struct node
{
    int data;
    struct node *next;
} node_t;

//声明方法
node_t *create_list(int *data, int length)
void print_list(node_t *list)
void free_list(node_t *list)

//结束语句
#endif
```

然后在链表的`.c`文件中[[C 函数#函数声明|实现]]针对链表的方法，包括增、删、查等。

```c
#include <stdio.h>
#include <stdlib.h>
#include "link.h"

//实现函数
```

### 复合类型实现

```components
componentId: e11db396-efbf-4903-b5b4-1bd8c24c3d89

```