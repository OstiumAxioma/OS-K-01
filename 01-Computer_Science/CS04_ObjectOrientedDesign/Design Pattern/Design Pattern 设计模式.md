https://refactoringguru.cn/design-patterns/catalog

## 设计模式是什么？

**设计模式**是软件设计中常见问题的典型解决方案。 它们就像能根据需求进行调整的预制蓝图， 可用于解决代码中反复出现的设计问题。

设计模式与方法或库的使用方式不同， 你很难直接在自己的程序中套用某个设计模式。 模式并不是一段特定的代码， 而是解决特定问题的一般性概念。 你可以根据模式来实现符合自己程序实际所需的解决方案。

人们常常会混淆模式和算法， 因为两者在概念上都是已知特定问题的典型解决方案。 但算法总是明确定义达成特定目标所需的一系列步骤， 而模式则是对解决方案的更高层次描述。 同一模式在两个不同程序中的实现代码可能会不一样。

算法更像是菜谱： 提供达成目标的明确步骤。 而模式更像是蓝图： 你可以看到最终的结果和模式的功能， 但需要自己确定实现步骤。

### 模式包含哪些内容？

大部分模式都有正规的描述方式， 以便在不同情况下使用。 模式的描述通常会包括以下部分：

- **意图**部分简单描述问题和解决方案。
- **动机**部分将进一步解释问题并说明模式会如何提供解决方案。
- **结构**部分展示模式的每个部分和它们之间的关系。
- **在不同语言中的实现**提供流行编程语言的代码， 让读者更好地理解模式背后的思想。

部分模式介绍中还列出其他的一些实用细节， 例如模式的适用性、 实现步骤以及与其他模式的关系。

## 模式的历史

谁发明了设计模式？ 这是一个很好的问题， 但也有点不太准确。 设计模式并不是晦涩的、 复杂的概念——事实恰恰相反。 模式是面向对象设计中常见问题的典型解决方案。 同样的解决方案在各种项目中得到了反复使用， 所以最终有人给它们起了名字， 并对其进行了详细描述。 这基本上就是模式被发现的历程了。

模式的概念是由克里斯托佛·亚历山大在其著作 《[建筑模式语言](https://refactoringguru.cn/pattern-language-book)》 中首次提出的。 本书介绍了城市设计的 “语言”， 而此类 “语言” 的基本单元就是模式。 模式中可能会包含对窗户应该在多高、 一座建筑应该有多少层以及一片街区应该有多大面积的植被等信息的描述。

埃里希·伽玛、 约翰·弗利赛德斯、 拉尔夫·约翰逊和理查德·赫尔姆这四位作者接受了模式的概念。 1994 年， 他们出版了 《[设计模式： 可复用面向对象软件的基础](https://refactoringguru.cn/gof-book)》 一书， 将设计模式的概念应用到程序开发领域中。 该书提供了 23 个模式来解决面向对象程序设计中的各种问题， 很快便成为了畅销书。 由于书名太长， 人们将其简称为 “四人组 （Gang of Four， GoF） 的书”， 并且很快进一步简化为 “GoF 的书”。

此后， 人们又发现了几十种面向对象的模式。 ​ “模式方法” 开始在其他程序开发领域中流行起来。 如今， 在面向对象设计领域之外， 人们也提出了许多其他的模式。

## 为什么以及如何学习设计模式？

或许你已从事程序开发工作多年， 却完全不知道单例模式是什么。 很多人都是这样。 即便如此， 你可能也在不自知的情况下已经使用过一些设计模式了。 所以为什么不花些时间来更进一步学习它们呢？

- 设计模式是针对软件设计中常见问题的工具箱， 其中的工具就是各种**经过实践验证的解决方案**。 即使你从未遇到过这些问题， 了解模式仍然非常有用， 因为它能指导你如何使用面向对象的设计原则来解决各种问题。
    
- 设计模式定义了一种让你和团队成员能够更高效沟通的通用语言。 你只需说 “哦， 这里用单例就可以了”， 所有人都会理解这条建议背后的想法。 只要知晓模式及其名称， 你就无需解释什么是单例。
    

## 设计模式的基本概念

#### **封装**

也叫做信息隐藏或者数据访问保护。类通过暴露有限的访问接口，授权外部仅能通过类提供的方式（函数）来访问内部信息或者数据。

封装的特性，需要编程语言本身提供一定的语法机制来支持。这个语法机制就是访问控制权限。java中，有4种访问控制权限，public，private，protected，default.

封装的意义，如果没做访问控制的话，任何代码都可以访问、修改类中的属性，这样虽然看起来更加灵活，但是也意味着不可控，属性可以随意被各种修改，修改地方散落在各处，会印象代码的可读性、可维护性。

另外有一点，调用者并不需要太了解业务的细节，提供一些控制方法即可，这样可以最大限度的降低错误，减少出错的概率。

#### **抽象**

封装主要讲的是如何隐藏信息、保护数据，而抽象讲的是如何隐藏方法的具体实现，让调用者只需要关心方法提供了哪些功能，并不需要知道如何实现的。

面向对象编程中，通过借助编程语言提供的接口类（interface）或者抽象类（abstract）来实现抽象的特性。

抽象有时候不被看为是面向对象的情况，他可以用来指导架构设计，而且并不需要编程语言提供特殊的语法机制来支持，只需要提供“函数”这个基础的机制就可以实现抽象特性，这就是他有时候不被看作面向对象编程的特性之一。

在面对复杂系统的时候，人能承受的信息复杂程度是有限的，所以必须忽略掉一些关键性的实现细节。抽象作为一种只关注功能点不关注实现的设计思路，整好帮我妈过滤许多非必要的信息。

#### **继承**

继承是用来表示类之间的is-a关系，比如狗是一种动物。继承可以分为两种模式，单继承和多继承。单继承表示一个子类只继承一个父类，多继承表示一个子类可以继承多个父类。

java不支持多继承，为什么？ 多重继承有副作用：钻石问题（<mark style="background: #FFB86CA6;">==菱形继承==</mark>）

> [!quote] 菱形继承
> 假设类B和类C继承自A，都重写了类A中的同一个方法，而类D同时继承了类B和类C，那此时类D会继承B、C的方法，对于B、C重写的A的方法、类D会继承哪个？这里就是问题点，因此Java不支持多继承。但是java支持多接口实现，接口中的方法是抽象的，就算一个类有多个接口，且接口中存在同名方法，实现接口的时候，这个同名方法需要由自己类来实现。 继承的好处是代码复用。例如有一些相同的方法和属性，就可以将这些抽出来，放到父类中，两个子类继承父类即可。

#### **多态**

多态是指，子类可以替换父类，在实际的代码运行过程中，调用子类的实现。

多态可以提高代码的可扩展性和复用性。可以利用多态的特性，用一个print函数，实现遍历打印不同类型集合的数据。当再增加一种类型的时候，只需要实现接口就可以了。

## 设计模式的基本原则

### SOLID原则
在程序设计领域， SOLID（单一功能、开闭原则、里氏替换、接口隔离以及依赖反转）是由罗伯特·C·马丁在21世纪早期引入，指代了面向对象编程和面向对象设计的五个基本原则。当这些原则被一起应用时，它们使得一个程序员开发一个容易进行软件维护和扩展的系统变得更加可能。

在面向对象的计算机编程中，术语 SOLID 是对五大软件设计原则的助记缩写，这五个原则旨在让软件设计更易理解、更灵活、更易于维护。它与 GRASP 软件设计原则并无关系。这些软件设计原则是 Robert C. Martin 提出的众多原则中的一个子集。虽然它们适用于任何面向对象的设计，但是 SOLID 原则也可以形成诸如敏捷开发或者自适应软件开发等方法论的核心理念。Martin 在 2000年 的论文《设计原则与设计模式》中介绍了 SOLID 原则的理论

如果正确地遵循了 SOLID 原则，那么它将引导你写出维护性和可测试性更好的高质量代码。如果需求变更，你也可以轻松地修改代码（与不遵守 SOLID 的代码相比）。这些原则关注的是<mark style="background: #BBFABBA6;">可维护性、可测试性以及和人类思维相关的更高质代码</mark>，而不是你为之编码的计算机。工作在以性能为主的领域的开发者各自有着不同的编程方法。由于在我们生活的世界里，人工时间成本比机器时间成本更昂贵，所以大多数开发者都不在高性能需求的领域里工作，而且他们常常被鼓励去使用面向对象的编程方法。

## 设计模式分类

不同设计模式的复杂程度、 细节层次以及在整个系统中的应用范围等方面各不相同。 我喜欢将其类比于道路的建造： 如果你希望让十字路口更加安全， 那么可以安装一些交通信号灯， 或者修建包含行人地下通道在内的多层互通式立交桥。

最基础的、 底层的模式通常被称为**惯用技巧**。 这类模式一般只能在一种编程语言中使用。

最通用的、 高层的模式是**构架模式**。 开发者可以在任何编程语言中使用这类模式。 与其他模式不同， 它们可用于整个应用程序的架构设计。

此外， 所有模式可以根据其意图或目的来分类。 一共有三种主要的模式类别：

#### **创建型模式**
顾名思义就是用来创建对象的，其提供创建对象的机制， 增加已有代码的灵活性和可复用性。
#### **结构型模式**
介绍如何将对象和类组装成较大的结构， 并同时保持结构的灵活和高效。如何将对象和类组装成较大的结构，并同时保持结构的灵活和高效。结构型模式把一个个对象结合在一起，就像积木搭建起来一样，有一种结构化的感觉。 
#### **行为模式**
负责对象间的高效沟通和职责委派。要理解行为型模式，就要重点留意行为。虽然行为型模式有些点与结构型模式类似，但是其最大的特点是行为，是这个动起来的东西。